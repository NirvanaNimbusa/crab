<%inherit file="base.html"/>

<%block name="links">
<a href="/host/${info['host'] | h}">${info['host'] | h}</a>
<a href="/user/${info['user'] | h}">${info['user'] | h}</a>
% if info['jobid'] is not None:
<span>${info['jobid'] | h}</span>
% else:
<span>${info['command'] | h}</span>
% endif
</%block>


<h2>Job Information</h2>

<table>
<!--
    <tr>
        <th>Host</th>
        <td>${info["host"] | h}</td>
    </tr>
    <tr>
        <th>User</th>
        <td>${info["user"] | h}</td>
    </tr>
-->
% if info["jobid"] != None:
    <tr>
        <th>Job ID</th>
        <td>${info["jobid"] | h}</td>
    </tr>
% endif
    <tr>
        <th>Command</th>
        <td>${info["command"] | h}</td>
    </tr>
     <tr>
        <th>Schedule</th>
% if info["time"] != None:
        <td>${info["time"] | h}</td>
% else:
        <td class="status_unknown">Unknown</td>
% endif
    </tr>
% if info["timezone"] != None:
    <tr>
        <th>Time zone</th>
        <td>${info["timezone"] | h}</td>
    </tr>
% endif
% if info["installed"] != None:
    <tr>
        <th>Installed</th>
        <td>${info["installed"] | h}</td>
    </tr>
% endif
% if info["deleted"] != None:
    <tr>
        <th>Deleted</th>
        <td>${info["deleted"] | h}</td>
    </tr>
% endif



</table>

<h2>Job History</h2>

<table>
    <tr>
        <th>Action</th>
        <th>Date and Time</th>
        <th>Command</th>
        <th>Status</th>
    </tr>
% for event in events:
% if event["type"] == 1:
    <tr id="row_start_${event["id"] | h}">
        <td>Started</td>
% elif event["type"] == 2:
    <tr id="row_warning_${event["id"] | h}">
        <td>Warning</td>
% elif event["type"] == 3:
    <tr id="row_finish_${event["id"] | h}">
        <td>Finished</td>
% else:
    <tr>
        <td>Unknown event</td>
% endif
        <td>${event["datetime"] | h}</td>
% if event["command"] is not None:
        <td>${event["command"] | h}</td>
% else:
        <td>&nbsp;</td>
% endif
% if event["status"] is None:
        <td>&nbsp;</td>
% elif event["status"] == 0:
        <td class="statuscell"><a class="status_ok" href="/job/${id | h}/output/${event["id"] | h}">Succeeded</a></td>
% elif event["status"] == 1:
        <td class="statuscell"><a class="status_fail" href="/job/${id | h}/output/${event["id"] | h}">Failed</a></td>
% elif event["status"] == 2:
        <td class="statuscell"><a class="status_warn" href="/job/${id | h}/output/${event["id"] | h}">Unknown</a></td>
% elif event["status"] == 3:
        <td class="status_fail">Could not start</td>
% elif event["status"] == -1:
        <td class="status_ok">Late</td>
% elif event["status"] == -2:
        <td class="status_warn">Missed</td>
% elif event["status"] == -3:
        <td class="status_fail">Timed out</td>
% else:
        <td class="status_warn">Status ${event["status"] | h}</td>
% endif
    </tr>
% endfor
</table>
