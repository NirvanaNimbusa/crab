CREATE TABLE job (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    host VARCHAR(255) NOT NULL,
    user VARCHAR(255) NOT NULL,
    command VARCHAR(255) NOT NULL,
    commandid VARCHAR(255),
    minute INT,
    hour INT,
    day INT,
    month INT,
    dow INT,
    timezone VARCHAR(255),
    installed VARCHAR(255) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    deleted VARCHAR(255),
    UNIQUE (host, user, commandid)
);


CREATE TABLE jobstart (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    jobid INTEGER NOT NULL REFERENCES job(id)
        ON DELETE RESTRICT ON UPDATE RESTRICT,
    command VARCHAR(255) NOT NULL,
    datetime VARCHAR(255) NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE jobfinish (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    jobid INTEGER NOT NULL REFERENCES job(id)
        ON DELETE RESTRICT ON UPDATE RESTRICT,
    command VARCHAR(255) NOT NULL,
    datetime VARCHAR(255) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    status INT NOT NULL,
    stdout TEXT DEFAULT "" NOT NULL,
    stderr TEXT DEFAULT "" NOT NULL
);

